<nav class="navbar">
    <div class="container nav-container">
        <div class="nav-brand">
            <a href="{% url 'dashboard' %}" class="brand-link">
                <h2>Apartment Res</h2>
            </a>
            {% if user.is_staff %}
            <span class="admin-badge">Admin</span>
            {% endif %}
        </div>

        <button class="menu-toggle" id="menu-toggle" aria-label="Toggle Menu">
            <span class="hamburger"></span>
        </button>

        <div class="nav-drawer" id="nav-drawer">
            <ul class="nav-menu">
                <li class="drawer-label">Navigation</li>
                <li><a href="{% url 'dashboard' %}" class="nav-link">Dashboard</a></li>
                {% if user.is_staff %}
                <li><a href="{% url 'admin_dashboard' %}" class="nav-link">Admin Panel</a></li>
                {% endif %}
                <li><a href="{% url 'reservation_list' %}" class="nav-link">Reservations</a></li>
                
                <hr class="drawer-divider">
                
                <li class="nav-icons-group">
                    <a href="{% url 'inbox' %}" class="nav-icon-link">
                        <span>✉️ Messages</span>
                        {% if unread_messages_count > 0 %}
                        <span class="badge">{{ unread_messages_count }}</span>
                        {% endif %}
                    </a>
                </li>

                <div class="drawer-actions">
                    <a href="{% url 'reservation_create' %}" class="btn btn-primary btn-block">Book Now</a>
                    <div class="drawer-user">
                        <p>{{ user.username }}</p>
                        <a href="{% url 'logout' %}" class="logout-btn">Logout</a>
                    </div>
                </div>
            </ul>
        </div>
    </div>
</nav>

<div class="nav-overlay" id="nav-overlay"></div>

<script>
    const btn = document.getElementById('menu-toggle');
    const drawer = document.getElementById('nav-drawer');
    const overlay = document.getElementById('nav-overlay');

    function toggleMenu() {
        drawer.classList.toggle('active');
        overlay.classList.toggle('active');
        document.body.style.overflow = drawer.classList.contains('active') ? 'hidden' : 'initial';
    }

    btn.addEventListener('click', toggleMenu);
    overlay.addEventListener('click', toggleMenu);
</script>

<style>
/* --- Navbar Layout --- */
.navbar {
    background: #fff;
    padding: 12px 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    position: sticky;
    top: 0;
    z-index: 1000;
}

.nav-container {
    display: flex;
    justify-content: space-between; /* This pushes Logo left and Hamburger right */
    align-items: center;
}

/* --- Brand/Logo --- */
.nav-brand { display: flex; align-items: center; gap: 8px; }
.brand-link { text-decoration: none; color: #1e293b; }
.brand-link h2 { margin: 0; font-size: 1.1rem; font-weight: 800; }
.admin-badge { background: #fef3c7; color: #92400e; font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; font-weight: 700; }

/* --- Hamburger Icon --- */
.menu-toggle {
    background: none; border: none; cursor: pointer; padding: 8px; display: block;
}
.hamburger, .hamburger::before, .hamburger::after {
    content: ''; display: block; width: 22px; height: 2px; background: #1e293b; transition: 0.3s;
}
.hamburger { position: relative; }
.hamburger::before { position: absolute; top: -7px; left: 0; }
.hamburger::after { position: absolute; bottom: -7px; left: 0; }

/* --- Mobile Drawer (Hidden off-screen) --- */
.nav-drawer {
    position: fixed;
    top: 0;
    right: -100%; /* Completely off-screen initially */
    width: 280px;
    height: 100vh;
    background: #fff;
    z-index: 2000;
    padding: 2.5rem 1.5rem;
    box-shadow: -5px 0 25px rgba(0,0,0,0.1);
    transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.nav-drawer.active { right: 0; }

.nav-menu { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 1.25rem; }
.drawer-label { font-size: 0.75rem; text-transform: uppercase; color: #94a3b8; font-weight: 800; }
.nav-link { text-decoration: none; color: #334155; font-weight: 600; font-size: 1rem; }
.drawer-divider { border: 0; border-top: 1px solid #f1f5f9; margin: 10px 0; }

.btn-block { width: 100%; text-align: center; display: block; }
.drawer-actions { margin-top: auto; padding-top: 2rem; }

/* --- Overlay --- */
.nav-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.3); z-index: 1500; opacity: 0; pointer-events: none; transition: 0.3s;
}
.nav-overlay.active { opacity: 1; pointer-events: auto; }

/* --- Desktop View (Return to Header Bar) --- */
@media (min-width: 992px) {
    .menu-toggle { display: none; }
    .nav-drawer {
        position: static; width: auto; height: auto; background: none; padding: 0; 
        box-shadow: none; right: 0; transition: none;
    }
    .nav-menu { flex-direction: row; align-items: center; gap: 1.5rem; }
    .drawer-label, .drawer-divider, .drawer-user p { display: none; }
    .drawer-actions { margin: 0; padding: 0; display: flex; align-items: center; gap: 1rem; }
}
</style>
