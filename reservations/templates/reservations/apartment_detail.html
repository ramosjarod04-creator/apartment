{% extends 'base.html' %}

{% block title %} {{ apartment.name }} - Apartment Reservation {% endblock %}

{% block content %}
<div class="detail-wrapper">
    <div class="container detail-container">
        <!-- Breadcrumb Navigation -->
        <nav class="breadcrumb">
            <a href="{% url 'dashboard' %}">Home</a>
            <span class="separator">/</span>
            <a href="{% url 'apartment_list' %}">Apartments</a>
            <span class="separator">/</span>
            <span class="current">{{ apartment.name }}</span>
        </nav>

        <div class="apartment-detail">
            <!-- Header Section -->
            <div class="apartment-detail-header">
                <div class="header-content">
                    <div class="header-main">
                        <h1>{{ apartment.name }}</h1>
                        <span class="badge badge-{{ apartment.status }}">
                            <span class="badge-dot"></span>
                            {{ apartment.get_status_display }}
                        </span>
                    </div>
                    <div class="header-meta">
                        <span class="meta-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M2 6L8 2L14 6V13C14 13.5304 13.7893 14.0391 13.4142 14.4142C13.0391 14.7893 12.5304 15 12 15H4C3.46957 15 2.96086 14.7893 2.58579 14.4142C2.21071 14.0391 2 13.5304 2 13V6Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Unit {{ apartment.unit_number }}
                        </span>
                        <span class="meta-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <rect x="2" y="2" width="12" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M2 6H14" stroke="currentColor" stroke-width="1.5"/>
                            </svg>
                            Floor {{ apartment.floor }}
                        </span>
                    </div>
                </div>
                <button onclick="history.back()" class="btn-back">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M12 5L7 10L12 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Back</span>
                </button>
            </div>

            <!-- Main Content Grid -->
            <div class="apartment-detail-grid">
                <!-- Image Gallery Section -->
                <div class="image-section">
                    <div class="apartment-detail-image">
                        {% if apartment.image %}
                        <img src="{{ apartment.image.url }}" alt="{{ apartment.name }}" onerror="this.onerror=null; this.parentElement.innerHTML='<div class=\'apartment-placeholder-large\'><svg width=\'64\' height=\'64\' viewBox=\'0 0 24 24\' fill=\'none\'><rect x=\'3\' y=\'3\' width=\'18\' height=\'18\' rx=\'2\' stroke=\'currentColor\' stroke-width=\'1.5\'/><path d=\'M3 16L8 11L13 16M13 11L16 8L21 13\' stroke=\'currentColor\' stroke-width=\'1.5\' stroke-linecap=\'round\'/><circle cx=\'8.5\' cy=\'8.5\' r=\'1.5\' fill=\'currentColor\'/></svg><p>Image not available</p></div>';">
                        {% else %}
                        <div class="apartment-placeholder-large">
                            <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
                                <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M3 16L8 11L13 16M13 11L16 8L21 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <circle cx="8.5" cy="8.5" r="1.5" fill="currentColor"/>
                            </svg>
                            <p>No image uploaded</p>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Info Section -->
                <div class="apartment-detail-info">
                    <!-- Price Card -->
                    <div class="price-card">
                        <div class="price-header">
                            <div>
                                <p class="price-large">₱{{ apartment.price_per_month|floatformat:2 }}</p>
                                <span class="price-period">per month</span>
                            </div>
                        </div>

                        <!-- Quick Stats -->
                        <div class="quick-stats">
                            <div class="stat-item">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M2 8L10 2L18 8V17C18 17.5304 17.7893 18.0391 17.4142 18.4142C17.0391 18.7893 16.5304 19 16 19H4C3.46957 19 2.96086 18.7893 2.58579 18.4142C2.21071 18.0391 2 17.5304 2 17V8Z" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M7 19V10H13V19" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                                <div>
                                    <span class="stat-label">Type</span>
                                    <span class="stat-value">{{ apartment.get_apartment_type_display }}</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <rect x="2" y="2" width="16" height="16" rx="2" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M2 7H18M7 2V7M13 2V7" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                                <div>
                                    <span class="stat-label">Size</span>
                                    <span class="stat-value">{{ apartment.size_sqm }} m²</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <rect x="3" y="8" width="14" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M7 8V6C7 5.46957 7.21071 4.96086 7.58579 4.58579C7.96086 4.21071 8.46957 4 9 4H11C11.5304 4 12.0391 4.21071 12.4142 4.58579C12.7893 4.96086 13 5.46957 13 6V8" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                                <div>
                                    <span class="stat-label">Bedrooms</span>
                                    <span class="stat-value">{{ apartment.bedrooms }}</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M10 6V10L13 11.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                <div>
                                    <span class="stat-label">Bathrooms</span>
                                    <span class="stat-value">{{ apartment.bathrooms }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="detail-actions">
                            {% if apartment.status == 'available' %}
                            <a href="{% url 'reservation_create' %}?apartment={{ apartment.pk }}" class="btn btn-primary btn-lg btn-book">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <rect x="3" y="4" width="14" height="14" rx="2" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M3 8H17M7 2V6M13 2V6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                Book This Apartment
                            </a>
                            {% else %}
                            <button class="btn btn-disabled btn-lg" disabled>
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M6 10H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                </svg>
                                Not Available
                            </button>
                            {% endif %}
                            
                            {% if user.is_staff %}
                            <div class="admin-actions">
                                <a href="{% url 'apartment_update' apartment.pk %}" class="btn btn-secondary">
                                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                        <path d="M12.5 2.5L15.5 5.5L5.5 15.5H2.5V12.5L12.5 2.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    Edit
                                </a>
                                <a href="{% url 'apartment_delete' apartment.pk %}" class="btn btn-danger">
                                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                        <path d="M2.5 4.5H15.5M7 4.5V2.5H11V4.5M6 7.5V13.5M9 7.5V13.5M12 7.5V13.5M4.5 4.5L5.5 15.5H12.5L13.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                    Delete
                                </a>
                            </div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Description Section -->
                    <div class="info-card">
                        <h2 class="section-title">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M9 2H4C3.46957 2 2.96086 2.21071 2.58579 2.58579C2.21071 2.96086 2 3.46957 2 4V16C2 16.5304 2.21071 17.0391 2.58579 17.4142C2.96086 17.7893 3.46957 18 4 18H16C16.5304 18 17.0391 17.7893 17.4142 17.4142C17.7893 17.0391 18 16.5304 18 16V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M6 10H10M6 14H14M6 6H7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Description
                        </h2>
                        <p class="description-text">{{ apartment.description }}</p>
                    </div>

                    <!-- Amenities Section -->
                    <div class="info-card">
                        <h2 class="section-title">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M9 2L2 7V18H7V13H13V18H18V7L11 2H9Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Amenities & Features
                        </h2>
                        <ul class="amenities-list">
                            {% for amenity in apartment.get_amenities_list %}
                            <li>
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
                                    <path d="M5 8L7 10L11 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                {{ amenity }}
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
:root {
    --primary: #2563eb;
    --primary-hover: #1d4ed8;
    --primary-light: #eff6ff;
    --secondary: #64748b;
    --secondary-hover: #475569;
    --danger: #ef4444;
    --danger-hover: #dc2626;
    --success: #10b981;
    --dark: #1e293b;
    --gray-700: #334155;
    --gray-600: #475569;
    --gray-500: #64748b;
    --gray-400: #94a3b8;
    --gray-300: #cbd5e1;
    --gray-200: #e2e8f0;
    --gray-100: #f1f5f9;
    --gray-50: #f8fafc;
    --radius-2xl: 20px;
    --radius-xl: 16px;
    --radius-lg: 12px;
    --radius-md: 8px;
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

/* Wrapper */
.detail-wrapper {
    background: var(--gray-50);
    min-height: 100vh;
    padding: 2rem 0;
}

.detail-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
}

/* Breadcrumb */
.breadcrumb {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    font-size: 0.875rem;
    color: var(--gray-600);
}

.breadcrumb a {
    color: var(--gray-600);
    text-decoration: none;
    transition: color 0.2s;
}

.breadcrumb a:hover {
    color: var(--primary);
}

.breadcrumb .separator {
    color: var(--gray-400);
}

.breadcrumb .current {
    color: var(--dark);
    font-weight: 600;
}

/* Main Card */
.apartment-detail {
    background: white;
    border-radius: var(--radius-2xl);
    box-shadow: var(--shadow-md);
    overflow: hidden;
}

/* Header */
.apartment-detail-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 2rem 2.5rem;
    border-bottom: 1px solid var(--gray-100);
    gap: 2rem;
}

.header-content {
    flex: 1;
}

.header-main {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 0.75rem;
    flex-wrap: wrap;
}

.header-main h1 {
    margin: 0;
    font-size: 2rem;
    font-weight: 800;
    color: var(--dark);
    line-height: 1.2;
}

.header-meta {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
}

.meta-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--gray-600);
    font-size: 0.9rem;
    font-weight: 500;
}

.meta-item svg {
    color: var(--gray-400);
}

/* Badge */
.badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 100px;
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: capitalize;
}

.badge-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}

.badge-available {
    background: #d1fae5;
    color: #065f46;
}

.badge-available .badge-dot {
    background: #10b981;
}

.badge-occupied {
    background: #fee2e2;
    color: #991b1b;
}

.badge-occupied .badge-dot {
    background: #ef4444;
}

.badge-maintenance {
    background: #fef3c7;
    color: #92400e;
}

.badge-maintenance .badge-dot {
    background: #f59e0b;
}

/* Back Button */
.btn-back {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    background: white;
    border: 2px solid var(--gray-200);
    border-radius: var(--radius-md);
    color: var(--gray-700);
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-back:hover {
    background: var(--gray-50);
    border-color: var(--gray-300);
    transform: translateX(-2px);
}

/* Grid Layout */
.apartment-detail-grid {
    display: grid;
    grid-template-columns: 1.3fr 1fr;
    gap: 3rem;
    padding: 2.5rem;
}

/* Image Section */
.image-section {
    position: relative;
}

.apartment-detail-image {
    position: sticky;
    top: 2rem;
}

.apartment-detail-image img {
    width: 100%;
    aspect-ratio: 16/11;
    object-fit: cover;
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
}

.apartment-placeholder-large {
    width: 100%;
    aspect-ratio: 16/11;
    background: var(--gray-100);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    border-radius: var(--radius-xl);
    color: var(--gray-400);
    border: 2px dashed var(--gray-300);
}

.apartment-placeholder-large svg {
    color: var(--gray-300);
}

.apartment-placeholder-large p {
    margin: 0;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--gray-500);
}

/* Info Section */
.apartment-detail-info {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

/* Price Card */
.price-card {
    background: linear-gradient(135deg, var(--primary) 0%, #1d4ed8 100%);
    padding: 2rem;
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-lg);
    color: white;
}

.price-header {
    margin-bottom: 2rem;
}

.price-large {
    margin: 0;
    font-size: 3rem;
    font-weight: 800;
    line-height: 1;
    color: white;
}

.price-period {
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
}

/* Quick Stats */
.quick-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.25rem;
    margin-bottom: 2rem;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: var(--radius-md);
    backdrop-filter: blur(10px);
}

.stat-item svg {
    flex-shrink: 0;
    color: rgba(255, 255, 255, 0.9);
}

.stat-item div {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.stat-label {
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.7);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.stat-value {
    font-size: 0.95rem;
    font-weight: 700;
    color: white;
}

/* Info Cards */
.info-card {
    background: white;
    padding: 1.75rem;
    border-radius: var(--radius-lg);
    border: 1px solid var(--gray-200);
}

.section-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin: 0 0 1.25rem 0;
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--dark);
}

.section-title svg {
    color: var(--primary);
}

.description-text {
    color: var(--gray-600);
    line-height: 1.7;
    margin: 0;
    font-size: 0.95rem;
}

/* Amenities List */
.amenities-list {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.75rem;
    list-style: none;
    padding: 0;
    margin: 0;
}

.amenities-list li {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--gray-50);
    border-radius: var(--radius-md);
    color: var(--gray-700);
    font-size: 0.9rem;
    font-weight: 500;
    transition: all 0.2s;
}

.amenities-list li:hover {
    background: var(--primary-light);
    color: var(--primary);
}

.amenities-list li svg {
    flex-shrink: 0;
    color: var(--success);
}

/* Action Buttons */
.detail-actions {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.875rem 1.5rem;
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 0.95rem;
    text-decoration: none;
    transition: all 0.2s;
    border: 2px solid transparent;
    cursor: pointer;
    font-family: inherit;
}

.btn-lg {
    padding: 1rem 1.75rem;
    font-size: 1rem;
}

.btn-primary {
    background: white;
    color: var(--primary);
    border-color: rgba(255, 255, 255, 0.3);
}

.btn-primary:hover {
    background: rgba(255, 255, 255, 0.95);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.btn-book {
    font-size: 1.1rem;
    font-weight: 700;
}

.btn-disabled {
    background: rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.6);
    cursor: not-allowed;
    border-color: rgba(255, 255, 255, 0.2);
}

.btn-secondary {
    background: var(--gray-100);
    color: var(--gray-700);
}

.btn-secondary:hover {
    background: var(--gray-200);
    color: var(--dark);
}

.btn-danger {
    background: var(--danger);
    color: white;
}

.btn-danger:hover {
    background: var(--danger-hover);
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(239, 68, 68, 0.3);
}

.admin-actions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

/* Tablet Styles */
@media (max-width: 1200px) {
    .apartment-detail-grid {
        grid-template-columns: 1fr;
        gap: 2.5rem;
    }

    .apartment-detail-image {
        position: relative;
        top: 0;
    }

    .quick-stats {
        grid-template-columns: repeat(4, 1fr);
    }
}

/* Mobile Styles */
@media (max-width: 768px) {
    .detail-wrapper {
        padding: 0;
        background: white;
    }

    .detail-container {
        padding: 0;
    }

    .breadcrumb {
        padding: 1rem 1.25rem 0;
        margin-bottom: 1rem;
    }

    .apartment-detail {
        border-radius: 0;
        box-shadow: none;
    }

    .apartment-detail-header {
        flex-direction: column;
        padding: 1.5rem 1.25rem;
        gap: 1.25rem;
    }

    .header-main {
        width: 100%;
    }

    .header-main h1 {
        font-size: 1.5rem;
    }

    .header-meta {
        gap: 1rem;
    }

    .btn-back {
        align-self: flex-start;
    }

    .apartment-detail-grid {
        padding: 1.25rem;
        gap: 1.5rem;
    }

    .apartment-detail-image img,
    .apartment-placeholder-large {
        border-radius: var(--radius-lg);
    }

    .price-card {
        padding: 1.5rem;
    }

    .price-large {
        font-size: 2.25rem;
    }

    .quick-stats {
        grid-template-columns: 1fr 1fr;
        gap: 0.75rem;
    }

    .stat-item {
        padding: 0.75rem;
    }

    .stat-label {
        font-size: 0.7rem;
    }

    .stat-value {
        font-size: 0.875rem;
    }

    .info-card {
        padding: 1.25rem;
    }

    .section-title {
        font-size: 1.1rem;
    }

    .amenities-list li {
        font-size: 0.875rem;
        padding: 0.625rem;
    }

    .admin-actions {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 480px) {
    .header-main h1 {
        font-size: 1.25rem;
    }

    .price-large {
        font-size: 2rem;
    }

    .quick-stats {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}
